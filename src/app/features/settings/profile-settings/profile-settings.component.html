<!-- src/app/features/settings/profile-settings/profile-settings.component.html -->
<div class="container mx-auto px-4 py-6">
  <div class="space-y-8 bg-white shadow-lg rounded-lg p-6">
      <!-- Loading State -->
      <div *ngIf="isLoadingProfile" class="flex justify-center items-center h-32">
          <div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-primary"></div>
      </div>

      <!-- Profile Settings -->
      <div *ngIf="!isLoadingProfile && profile" class="space-y-6">
          <!-- Profile Info -->
          <div class="bg-gray-50 p-4 rounded-lg shadow">
              <h2 class="text-lg font-semibold text-gray-800 mb-4">Profile Information</h2>
              
              <form [formGroup]="profileForm" (ngSubmit)="updateProfile()">
                  <div class="space-y-4">
                      <div>
                          <label for="full_name" class="block text-sm font-medium text-gray-700">Full Name</label>
                          <input type="text" id="full_name" formControlName="full_name"
                                 class="form-input mt-1 p-2 border border-gray-300 rounded-md">
                          <div *ngIf="profileForm.get('full_name')?.touched && profileForm.get('full_name')?.invalid" class="text-red-500 text-sm mt-1">
                              Full name is required
                          </div>
                      </div>

                      <div>
                          <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                          <input type="email" id="email" [value]="user?.email" disabled
                                 class="form-input mt-1 bg-gray-100 p-2 border border-gray-300 rounded-md">
                          <div class="text-xs text-gray-500 mt-1">
                              Email cannot be changed
                          </div>
                      </div>

                      <div>
                          <label for="avatar_url" class="block text-sm font-medium text-gray-700">Profile Picture URL</label>
                          <input type="url" id="avatar_url" formControlName="avatar_url"
                                 class="form-input mt-1 p-2 border border-gray-300 rounded-md">
                      </div>

                      <div class="flex justify-end">
                          <button type="submit" 
                                  [disabled]="profileForm.invalid || isUpdatingProfile"
                                  class="btn btn-primary">
                              <span *ngIf="isUpdatingProfile" class="mr-2">
                                  <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                  </svg>
                              </span>
                              Update Profile
                          </button>
                      </div>
                  </div>
              </form>
          </div>
          
          <!-- Password Update -->
          <div class="bg-gray-50 p-4 rounded-lg shadow">
              <h2 class="text-lg font-semibold text-gray-800 mb-4">Change Password</h2>
              
              <form [formGroup]="passwordForm" (ngSubmit)="updatePassword()">
                  <div class="space-y-4">
                      <div>
                          <label for="current_password" class="block text-sm font-medium text-gray-700">Current Password</label>
                          <input type="password" id="current_password" formControlName="current_password"
                                 class="form-input mt-1 p-2 border border-gray-300 rounded-md">
                          <div *ngIf="passwordForm.get('current_password')?.touched && passwordForm.get('current_password')?.invalid" class="text-red-500 text-sm mt-1">
                              Current password is required
                          </div>
                      </div>

                      <div>
                          <label for="new_password" class="block text-sm font-medium text-gray-700">New Password</label>
                          <input type="password" id="new_password" formControlName="new_password"
                                 class="form-input mt-1 p-2 border border-gray-300 rounded-md">
                          <div *ngIf="passwordForm.get('new_password')?.touched && passwordForm.get('new_password')?.invalid" class="text-red-500 text-sm mt-1">
                              Password must be at least 6 characters
                          </div>
                      </div>

                      <div>
                          <label for="confirm_password" class="block text-sm font-medium text-gray-700">Confirm New Password</label>
                          <input type="password" id="confirm_password" formControlName="confirm_password"
                                 class="form-input mt-1 p-2 border border-gray-300 rounded-md">
                          <div *ngIf="passwordForm.get('confirm_password')?.touched && passwordForm.hasError('mismatch')" class="text-red-500 text-sm mt-1">
                              Passwords do not match
                          </div>
                      </div>

                      <div class="flex justify-end">
                          <button type="submit" 
                                  [disabled]="passwordForm.invalid || isUpdatingPassword"
                                  class="btn btn-primary">
                              <span *ngIf="isUpdatingPassword" class="mr-2">
                                  <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                  </svg>
                              </span>
                              Change Password
                          </button>
                      </div>
                  </div>
              </form>
          </div>
      </div>
  </div>
</div>